{
    "instance_id": "django__django-16041",
    "model_name_or_path": "codestory-mixed",
    "model_patch": "diff --git a/django/forms/formsets.py b/django/forms/formsets.py\nindex 57676428ff..217d7ed87f 100644\n--- a/django/forms/formsets.py\n+++ b/django/forms/formsets.py\n@@ -214,7 +214,10 @@ class BaseFormSet(RenderableFormMixin):\n         index will be None if the form being constructed is a new empty\n         form.\n         \"\"\"\n-        return self.form_kwargs.copy()\n+        kwargs = self.form_kwargs.copy()\n+        if index is None:\n+            kwargs.pop('empty_permitted', None)\n+        return kwargs\n \n     def _construct_form(self, i, **kwargs):\n         \"\"\"Instantiate and return the i-th form instance in a formset.\"\"\"\n@@ -236,10 +239,17 @@ class BaseFormSet(RenderableFormMixin):\n                 defaults[\"initial\"] = self.initial[i]\n             except IndexError:\n                 pass\n-        # Allow extra forms to be empty, unless they're part of\n-        # the minimum forms.\n-        if i >= self.initial_form_count() and i >= self.min_num:\n-            defaults[\"empty_permitted\"] = True\n+        \n+        # Handle empty_form case\n+        if i is None:\n+            kwargs.pop('empty_permitted', None)\n+        else:\n+            # Allow extra forms to be empty, unless they're part of\n+            # the minimum forms.\n+            if i >= self.initial_form_count() and i >= self.min_num:\n+                if 'empty_permitted' not in kwargs:\n+                    kwargs['empty_permitted'] = True\n+\n         defaults.update(kwargs)\n         form = self.form(**defaults)\n         self.add_fields(form, i)\n@@ -257,12 +267,14 @@ class BaseFormSet(RenderableFormMixin):\n \n     @property\n     def empty_form(self):\n+        form_kwargs = self.get_form_kwargs(None)\n+        form_kwargs.pop('empty_permitted', None)\n+        form_kwargs['empty_permitted'] = True\n         form = self.form(\n             auto_id=self.auto_id,\n             prefix=self.add_prefix(\"__prefix__\"),\n-            empty_permitted=True,\n             use_required_attribute=False,\n-            **self.get_form_kwargs(None),\n+            **form_kwargs,\n             renderer=self.renderer,\n         )\n         self.add_fields(form, None)\n",
    "resolved": true
}