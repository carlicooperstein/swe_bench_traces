{
    "instance_id": "pytest-dev__pytest-11143",
    "model_name_or_path": "codestory-mixed",
    "model_patch": "diff --git a/src/_pytest/assertion/rewrite.py b/src/_pytest/assertion/rewrite.py\nindex 157903faf..5c2bf38fa 100644\n--- a/src/_pytest/assertion/rewrite.py\n+++ b/src/_pytest/assertion/rewrite.py\n@@ -667,8 +667,10 @@ class AssertionRewriter(ast.NodeVisitor):\n         # docstrings and __future__ imports, so first figure out where that is.\n         doc = getattr(mod, \"docstring\", None)\n         expect_docstring = doc is None\n-        if doc is not None and self.is_rewrite_disabled(doc):\n-            return\n+        if doc is not None:\n+            if isinstance(doc, str) and self.is_rewrite_disabled(doc):\n+                return\n+            expect_docstring = False\n         pos = 0\n         item = None\n         for item in mod.body:\n@@ -676,6 +678,7 @@ class AssertionRewriter(ast.NodeVisitor):\n                 expect_docstring\n                 and isinstance(item, ast.Expr)\n                 and isinstance(item.value, ast.Constant)\n+                and isinstance(item.value.value, str)\n             ):\n                 doc = item.value.value\n                 if self.is_rewrite_disabled(doc):\n",
    "resolved": true
}